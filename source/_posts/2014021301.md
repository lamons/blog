---
title: 利用 csvtools 宏包在 LaTeX 中實現 mail merge
tags:
  - tech
date: 2014-02-13 02:55:00
---

.csv 文件的內容如下：

```
Mr,Name,Address,Time,Date

Miss,Zhao,The University of Nottingham Ningbo China\\Taikang East Rd. \#199\\ZJ Ningbo 315100,12:00,4th May 2004

Mr,Qian,The University of Nottingham Ningbo China\\Taikang East Rd. \#199\\ZJ Ningbo 315101,13:00,11th May 2004

Ms,Sun,The University of Nottingham Ningbo China\\Taikang East Rd. \#199\\ZJ Ningbo 315102,14:00,18th May 2004

Dr,Li,The University of Nottingham Ningbo China\\Taikang East Rd. \#199\\ZJ Ningbo 315103,15:00,25th May 2004
```

之前我還嘗試了專門用於郵件合併的 mailmerge 宏包， 但是此包的使用非常麻煩，需要將所有的數據都寫在源文件中，而且每組數據都需要單獨的 \mailentry 命令來定義。相較之下，將數據存在csv文件中當然方便很多，而且還可以兼容 MS Excel。

調用 .csv 文件：`\applyCSVfile{<filename>}{<text>}`

默認是設表頭的內容爲 field 的名字，如 Mr，Name 等，插入 field 共有三種方法，`\insert<text>`，`\insertbyname{<text>}` 或是 `\field{<col>}`，效果是一樣的，如 `\insertName` 或是 `\insertbyname{Name}`。第三種是用於沒有表頭的情況，直接用序號來調用不同的列。
效果：

![](/imgs/2014021301/8171754_orig.png)
